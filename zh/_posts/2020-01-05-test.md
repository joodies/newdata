---
layout: post
title: XXXXXX
lang: zh
tags: 
stickie: 
---

## 在自动化测试中使用


|<font size="2px" color="#cc4100">确诊</font>|疑似|死亡|治愈|
|--|:|--|:|--|:|--|
刘备|哭|大哥
关羽|打|二哥
张飞|骂|三弟

#### Web UI自动化测试中的示例步骤

+ 使用您想要的任何Snapmail电子邮件地址在您的网站中注册一个新用户，例如**richard@snapmail.cc**。

+ 然后，您的电子邮件服务会将帐户验证电子邮件发送到richard@snapmail.cc
    
    你可以使用Snapmail SMTP来发邮件，如果你没有SMTP服务。 <a target='_blank' href="https://www.snapmail.cc/blog/zh/2019/11/30/snapmail-smtp.html">查看详情 ></a> 

+ 现在是时候使用Snapmail API来获取验证邮件了，空谈无用，给我看看代码。
    ```  
    # example in C# code  
    using Newtonsoft.Json.Linq;
    using System;
    using System.Net.Http;
    using System.Text.RegularExpressions;
    using System.Threading;
    using System.Threading.Tasks;
    
    namespace ConsoleApp1
    {
        class Program
        {
            static HttpClient client = new HttpClient();
            static void Main(string[] args)
            {
                Task t = new Task(GetValidationCode);
                t.Start();
                Console.ReadLine();
            }
    
            private static async void GetValidationCode()
            {
                // Get emails from an email box
                var url = "https://www.snapmail.cc/emaillist/richard@snapmail.cc";
                // We want to get account validation code in email
                var validation_code = "";
    
                // We will retry the request every 6 seconds to get the email
                for (int i = 0; i < 50; i++)
                {
                    HttpResponseMessage response = await client.GetAsync(url);
                    // If the response status is 200
                    if (response.StatusCode == System.Net.HttpStatusCode.OK)
                    {
                        var result = await response.Content.ReadAsStringAsync();
                        // Get the emails in array format
                        var emails = JArray.Parse(result);
                        // Get the email text of first email, 
                        // take "This is a test email." for example.
                        // email_text = "This is a test email."
                        var email_text = emails[0]["text"].ToString();
                        Regex regex = new Regex("This is a ([\\da-zA-Z0-9]{4}) email");
                        Match match = regex.Match(email_text);
                        // Use regex to get the validation code, we'll get "test" here.
                        // validation_code = "test"
                        validation_code = match.Groups[1].Value; 
                        Console.WriteLine(validation_code);
                        break;
                    }
                    Console.WriteLine("Waiting for next try");
                    // Sleep 6 seconds
                    Thread.Sleep(6000);
                }
    
            }
        }
    }

    ```

+ 您可以使用任何想要的电子邮件地址，建议在这种情况下使用前缀电子邮件地址，无需将其添加到Snapmail.cc

<a target="_blank" href="https://www.snapmail.cc"><i class="fa fa-envelope a"></i> 体验Snapmail </a>

<a href="https://www.snapmail.cc/blog/"><i class="fa fa-arrow-circle-left"></i> 返回到首页 </a>